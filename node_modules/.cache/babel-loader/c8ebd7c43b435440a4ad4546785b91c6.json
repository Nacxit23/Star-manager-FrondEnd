{"remainingRequest":"/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/node_modules/babel-loader/lib/index.js!/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/src/components/StarsList/StarsList.js?vue&type=script&lang=js&","dependencies":[{"path":"/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/src/components/StarsList/StarsList.js","mtime":1555974601593},{"path":"/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/node_modules/cache-loader/dist/cjs.js","mtime":1549926009192},{"path":"/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/node_modules/babel-loader/lib/index.js","mtime":1549926008785},{"path":"/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1549926008774}],"contextDependencies":[],"result":["import _objectSpread from \"/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.array.find-index\";\nimport _toConsumableArray from \"/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport * as queries from './StarsListQuery.gql';\nimport Modal from '@/components/Modal';\nexport default {\n  name: 'StarsList',\n  inject: ['context'],\n  data: function data() {\n    return {\n      status: '',\n      users: [],\n      description: '',\n      idStar: '',\n      showModal: false,\n      spinnerLoading: false,\n      alluserStar: [],\n      NoPaidStarUser: [],\n      userId: undefined\n    };\n  },\n  components: {\n    Modal: Modal\n  },\n  apollo: {\n    users: {\n      query: queries.users,\n      variables: function variables() {\n        return {\n          status: this.status\n        };\n      }\n    }\n  },\n  methods: {\n    modal: function modal(node, userId) {\n      this.userId = userId;\n      this.description = node.description || '';\n      this.idStar = node.id || 0;\n      this.showModal = true;\n      this.PaidAtStar = node.paidAt;\n    },\n    loadMore: function () {\n      var _loadMore = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.spinnerLoading = true;\n                _context.next = 3;\n                return this.$apollo.queries.users.fetchMore({\n                  variables: {\n                    curso: this.users.pageInfo.endCursor\n                  },\n                  updateQuery: function updateQuery(previousResult, _ref) {\n                    var users = _ref.fetchMoreResult.users;\n                    return {\n                      users: {\n                        __typename: previousResult.users.__typename,\n                        edges: [].concat(_toConsumableArray(previousResult.users.edges), _toConsumableArray(users.edges)),\n                        pageInfo: users.pageInfo\n                      }\n                    };\n                  }\n                });\n\n              case 3:\n                this.spinnerLoading = false;\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function loadMore() {\n        return _loadMore.apply(this, arguments);\n      }\n\n      return loadMore;\n    }(),\n    deleteStar: function deleteStar() {\n      var _this = this;\n\n      this.$apollo.mutate({\n        mutation: queries.deleteStar,\n        variables: {\n          id: this.idStar\n        },\n        update: function update(cache) {\n          var starQuery = {\n            query: queries.users,\n            variables: {\n              status: _this.status\n            }\n          };\n          var data = cache.readQuery(starQuery);\n          var userIndex = data.users.edges.findIndex(function (_ref2) {\n            var node = _ref2.node;\n            return node.id === _this.userId;\n          });\n          var starIndex = data.users.edges[userIndex].node.stars.edges.findIndex(function (_ref3) {\n            var node = _ref3.node;\n            return node.id == _this.idStar;\n          });\n          _this.showModal = false;\n          data.users.edges[userIndex].node.stars.edges.splice(starIndex, 1);\n          cache.writeQuery(_objectSpread({}, starQuery, {\n            data: data\n          }));\n        }\n      });\n    }\n  },\n  computed: {\n    allUser: function allUser() {\n      return this.alluserStar = (this.users.edges || []).map(function (edge) {\n        return edge.node;\n      });\n    }\n  }\n};",{"version":3,"sources":["/home/nacxit/Documentos/Proyectos/Web/ProyectoPasantia/stars-manager-front/src/components/StarsList/StarsList.js"],"names":["queries","Modal","name","inject","data","status","users","description","idStar","showModal","spinnerLoading","alluserStar","NoPaidStarUser","userId","undefined","components","apollo","query","variables","methods","modal","node","id","PaidAtStar","paidAt","loadMore","$apollo","fetchMore","curso","pageInfo","endCursor","updateQuery","previousResult","fetchMoreResult","__typename","edges","deleteStar","mutate","mutation","update","cache","starQuery","readQuery","userIndex","findIndex","starIndex","stars","splice","writeQuery","computed","allUser","map","edge"],"mappings":"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","sourcesContent":["import * as queries from './StarsListQuery.gql';\nimport Modal from '@/components/Modal';\n\nexport default {\n  name: 'StarsList',\n  inject: ['context'],\n  data() {\n    return {\n      status: '',\n      users: [],\n      description: '',\n      idStar: '',\n      showModal: false,\n      spinnerLoading: false,\n      alluserStar: [],\n      NoPaidStarUser: [],\n      userId: undefined,\n    };\n  },\n\n  components: {\n    Modal,\n  },\n\n  apollo: {\n    users: {\n      query: queries.users,\n      variables() {\n        return {\n          status: this.status,\n        };\n      },\n    },\n  },\n\n  methods: {\n    modal(node, userId) {\n      this.userId = userId;\n      this.description = node.description || '';\n      this.idStar = node.id || 0;\n      this.showModal = true;\n      this.PaidAtStar = node.paidAt;\n    },\n\n    async loadMore() {\n      this.spinnerLoading = true;\n      await this.$apollo.queries.users.fetchMore({\n        variables: {\n          curso: this.users.pageInfo.endCursor,\n        },\n        updateQuery: (previousResult, {fetchMoreResult: {users}}) => ({\n          users: {\n            __typename: previousResult.users.__typename,\n            edges: [...previousResult.users.edges, ...users.edges],\n            pageInfo: users.pageInfo,\n          },\n        }),\n      });\n      this.spinnerLoading = false;\n    },\n    deleteStar() {\n      this.$apollo.mutate({\n        mutation: queries.deleteStar,\n        variables: {\n          id: this.idStar,\n        },\n        update: cache => {\n          const starQuery = {\n            query: queries.users,\n            variables: {\n              status: this.status,\n            },\n          };\n          const data = cache.readQuery(starQuery);\n\n          const userIndex = data.users.edges.findIndex(\n            ({node}) => node.id === this.userId\n          );\n\n          const starIndex = data.users.edges[\n            userIndex\n          ].node.stars.edges.findIndex(({node}) => node.id == this.idStar);\n\n          this.showModal = false;\n\n          data.users.edges[userIndex].node.stars.edges.splice(starIndex, 1);\n          cache.writeQuery({\n            ...starQuery,\n            data: data,\n          });\n        },\n      });\n    },\n  },\n  computed: {\n    allUser() {\n      return (this.alluserStar = (this.users.edges || []).map(\n        edge => edge.node\n      ));\n    },\n  },\n};\n"]}]}